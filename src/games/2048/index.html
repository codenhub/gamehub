<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>2048 | GameHub</title>
    <link rel="stylesheet" href="../../_ui/main.css" />
    <script type="module" src="../../_ui/main.js"></script>
    <script src="../../_ui/components/index.js" type="module" defer></script>
    <script src="./index.ts" type="module" defer></script>

    <style>
      @reference "../../_ui/main.css";

      .game-grid {
        @apply grid grid-cols-4 gap-2 p-2 aspect-square;
      }

      .game-tile {
        @apply pixel-corner-lg-4 flex items-center justify-center aspect-square text-5xl md:text-7xl font-bold bg-background transition duration-200 select-none;
      }

      .game-tile[data-value]:not([data-value="0"]) {
        animation: tile-pop 0.12s ease-out;
      }

      @keyframes tile-pop {
        0% {
          transform: scale(0.85);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }
    </style>
  </head>
  <body>
    <gh-header title="2048" backBtn></gh-header>

    <main class="flex flex-1 size-full justify-center p-4">
      <section class="flex flex-1 max-w-lg w-full h-auto gap-4 py-4 flex-col items-center">
        <!-- TOP BAR -->
        <div class="flex items-center w-full justify-between">
          <div class="flex gap-4 text-xs sm:text-sm">
            <p>
              Score:
              <span id="score">0</span>
            </p>
            <p>
              Best:
              <span id="high-score">0</span>
            </p>
          </div>
        </div>

        <!-- GAME BOARD -->
        <div class="relative bg-border pixel-corner-lg-4 p-1 w-full aspect-square">
          <div id="grid" class="game-grid size-full pixel-corner-lg-4 bg-foreground"></div>

          <!-- Start screen -->
          <div
            id="start-screen"
            class="absolute inset-0 bg-foreground/80 flex flex-col items-center justify-center gap-4 pixel-corner-lg-4 z-20"
          >
            <h2>2048</h2>
            <p class="text-center">Combine tiles to reach 2048!</p>
            <button id="start-btn" class="primary-btn">Play</button>
          </div>

          <!-- Game over screen -->
          <div
            id="game-over-screen"
            class="absolute inset-0 flex-col items-center justify-center gap-2 bg-foreground/80 pixel-corner-lg-4 z-20 hidden"
          >
            <h2 class="text-error">GAME OVER</h2>
            <p class="text-2xl mb-2">
              Score:
              <span id="final-score">0</span>
            </p>
            <button id="restart-btn" class="primary-btn">Try Again</button>
          </div>

          <!-- Win screen -->
          <div
            id="win-screen"
            class="absolute inset-0 flex-col items-center justify-center gap-2 bg-foreground/80 pixel-corner-lg-4 z-20 hidden"
          >
            <h2 class="text-success">YOU WON!</h2>
            <p class="text-2xl mb-2">
              Score:
              <span id="win-score">0</span>
            </p>
            <button id="win-restart-btn" class="primary-btn">Play Again</button>
          </div>
        </div>

        <!-- Hints -->
        <div class="hidden sm:flex text-text-secondary">
          <p>Use Arrow Keys or WASD to move tiles</p>
        </div>
        <div class="flex sm:hidden text-text-secondary">
          <p>Swipe to move tiles</p>
        </div>

        <!-- Mobile D-Pad -->
        <div class="flex flex-col items-center gap-2 sm:hidden">
          <button class="icon-btn size-14 upBtn" aria-label="Move Up">
            <gh-icon src="/assets/icons/chevron-up.webp" width="2rem"></gh-icon>
          </button>
          <div class="flex gap-2">
            <button class="icon-btn size-14 leftBtn" aria-label="Move Left">
              <span class="flex -rotate-90">
                <gh-icon src="/assets/icons/chevron-up.webp" width="2rem"></gh-icon>
              </span>
            </button>
            <button class="icon-btn size-14 downBtn" aria-label="Move Down">
              <span class="flex rotate-180">
                <gh-icon src="/assets/icons/chevron-up.webp" width="2rem"></gh-icon>
              </span>
            </button>
            <button class="icon-btn size-14 rightBtn" aria-label="Move Right">
              <span class="flex rotate-90">
                <gh-icon src="/assets/icons/chevron-up.webp" width="2rem"></gh-icon>
              </span>
            </button>
          </div>
        </div>
      </section>
    </main>
  </body>
</html>
